/* EXERCICIO 1 */

    SELECT P_TYPE,
           AVG(P_RETAILPRICE) AS AVG_RETAILPRICE
    FROM PART
    WHERE P_RETAILPRICE BETWEEN 2095.10 AND 2097.90
    GROUP BY P_TYPE;

/* EXERCICIO 2 */

    SELECT O_ORDERSTATUS,
           MAX(O_TOTALPRICE) AS MAX_TOTALPRICE
    FROM ORDERS
    GROUP BY O_ORDERSTATUS;

/* EXERCICIO 3 */

    SELECT AVG( T1.PS_SUPPLYCOST ),
           T2.P_TYPE

    FROM PARTSUPP AS T1

    LEFT JOIN PART AS T2
    ON T1.PS_PARTKEY = T2.P_PARTKEY

    WHERE T2.P_TYPE = 'PROMO POLISHED COPPER'
    GROUP BY T2.P_TYPE;


/* EXERCICIO 4 */
    SELECT T1.O_ORDERSTATUS,
           MAX(T2.L_DISCOUNT)
    
    FROM ORDERS AS T1
    
    LEFT JOIN LINEITEM AS T2
    ON T1.O_ORDERKEY = T2.L_ORDERKEY
    
    WHERE T2.L_SHIPDATE BETWEEN '1998-11-11' AND '1998-12-31'
    GROUP BY T1.O_ORDERSTATUS;

/* EXERCICIO 5 */

    SELECT T1.C_NAME,
           AVG( T2.O_TOTALPRICE )
    
    FROM CUSTOMER AS T1
    
    INNER JOIN ORDERS AS T2
    ON T1.C_CUSTKEY = T2.O_CUSTKEY
    
    LEFT JOIN NATION AS T3
    ON T1.C_NATIONKEY = T3.N_NATIONKEY
    
    WHERE T3.N_NAME = 'BRAZIL'
    
    GROUP BY T1.C_NAME;

